# Test configuration to override application defaults
spring:

  data:
    mongodb:
      # Will be overridden by @DynamicPropertySource in integration tests
      uri: mongodb://localhost:27017/cartonization_test
      auto-index-creation: false

  redis:
    # Disable Redis for tests to avoid connection issues
    timeout: 1000ms
    host: localhost
    port: 6379

  cache:
    # Use simple cache for tests instead of Redis
    type: simple

  kafka:
    # Use standard serializers for tests, not Confluent Avro
    consumer:
      group-id: cartonization-service-test
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      enable-auto-commit: false
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer
      acks: all

# Disable security for tests
security:
  basic:
    enabled: false

# Logging for tests
logging:
  level:
    com.paklog.cartonization: DEBUG
    org.springframework.data.mongodb.core.MongoTemplate: WARN
    org.springframework.kafka: WARN
    org.testcontainers: WARN
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# Management endpoints for tests
management:
  endpoints:
    web:
      exposure:
        include: health,info

# Application configuration for tests
app:
  rest:
    connect-timeout: 5000
    read-timeout: 10000
    max-connections: 100
    logging-enabled: false
  async:
    core-pool-size: 2
    max-pool-size: 5
    queue-capacity: 50
    keep-alive-seconds: 30
    thread-name-prefix: "test-async-"
  scheduling:
    pool-size: 2
    thread-name-prefix: "test-scheduled-"
  redis:
    cache:
      default-ttl: 60s
      carton-ttl: 120s
      product-ttl: 180s
      packing-solution-ttl: 90s
  kafka:
    consumer:
      group-id: cartonization-service-test
      auto-offset-reset: earliest
      enable-auto-commit: false
      session-timeout-ms: 30000
      heartbeat-interval-ms: 10000
      max-poll-records: 500
      max-poll-interval-ms: 300000
      concurrency: 1
    producer:
      acks: all
      retries: 1
      batch-size: 1024
      linger-ms: 0
      buffer-memory: 33554432
      compression-type: none
      request-timeout-ms: 5000
      delivery-timeout-ms: 10000

# CORS configuration for tests
cors:
  allowed-origins:
    - http://localhost:3000
  allowed-methods:
    - GET
    - POST
    - PUT
    - DELETE
  allowed-headers:
    - "*"
  allow-credentials: false
  max-age: 3600